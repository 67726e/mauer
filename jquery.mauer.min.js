(function(b,a,c){b.mauer=function(d,f,e){this.$element=b(e);this.$window=b(a);this.options=b.extend(b.mauer.defaults,d);this.init();if(typeof f==="function"){f.call(e)}};b.mauer.defaults={columnWidth:360,gutterWidth:0,filter:c,initCallback:c,calculateCallback:c,mauerCallback:c,resizeCallback:c};b.mauer.prototype={columns:0,columnWidth:0,containerWidth:0,positions:new Array(0),init:function(){this.$element.data("mauer",this);this.resize();var d=this;this.$window.bind("resize.mauer",function(){d.resize.apply(d)});if(typeof this.options.initCallback==="function"){this.options.initCallback.call()}},resize:function(){if(this.columns&&this.$steine){for(var d=0;d<this.columns;d++){this.$steine.removeClass("col-"+d)}}this.calculate();this.mauer(this.$element.children().not(this.options.filter));if(typeof this.options.resizeCallback==="function"){this.options.resizeCallback.call()}},calculate:function(){this.columnWidth=this.options.columnWidth;this.$element.css("width","100%");this.containerWidth=this.$element.width();if(typeof this.columnWidth==="function"){this.columnWidth=this.columnWidth.call(this,this.containerWidth)}this.columns=Math.floor(this.containerWidth/this.columnWidth);this.positions=new Array(this.columns);this.$element.css("width",(this.columnWidth*this.columns)+"px");for(var d=0;d<this.columns;d++){this.positions[d]=0}if(typeof this.options.calculateCallback==="function"){this.options.calculateCallback.call()}},calculateColumn:function(){var f=0,d=this.positions[0];for(var e=0;e<this.positions.length;e++){if(this.positions[e]<d){d=this.positions[e];f=e}}return f},mauer:function(e){var d=this;e.each(function(i,j){var h=b(j);var k=d.calculateColumn();var f=k*d.columnWidth;var l=d.positions[k];var g=h.height();d.positions[k]+=g+10;h.css({position:"absolute",left:f,top:l});h.addClass("stein");h.addClass("col-"+k)})},append:function(d,e){this.mauer(d.not(this.options.filter));if(typeof e==="function"){e.call()}}};b.fn.mauer=function(f,h){var g=typeof f;switch(g){case"string":var e=Array.prototype.slice.call(arguments,1);var d=this.data("mauer");d[f].apply(d,e);if(typeof h==="function"){h.apply(d)}break;case"object":default:var d=this.data("mauer");if(d===c){d=new b.mauer(f,h,this)}break}}})(jQuery,window);